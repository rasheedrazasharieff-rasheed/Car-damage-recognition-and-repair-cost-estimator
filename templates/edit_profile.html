<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Profile</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Roboto:wght@400;500&display=swap');
        body { margin: 0; height: 100vh; background: #0f1115; display: flex; justify-content: center; align-items: center; font-family: 'Roboto', sans-serif; }

        .edit-box {
            width: 700px;
            background: #161b22;
            border: 1px solid #30363d;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            max-height: 90vh; /* Prevent overflow on small screens */
            overflow-y: auto;
        }

        h2 { color: #e0e0e0; border-bottom: 1px solid #30363d; padding-bottom: 10px; margin-top: 0; font-family: 'Share Tech Mono'; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        label { display: block; color: #8b949e; font-size: 0.75rem; margin-bottom: 5px; text-transform: uppercase; }

        input, select {
            width: 100%;
            background: #0d1117;
            border: 1px solid #30363d;
            padding: 10px;
            color: white;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        input:focus, select:focus { border-color: #58a6ff; outline: none; background: #1c2128; }

        /* Dropdown options styling */
        select option { background: #161b22; color: white; }

        .btn-save { width: 100%; padding: 12px; background: #238636; color: white; border: none; font-family: 'Share Tech Mono'; cursor: pointer; margin-top: 20px; font-size: 1rem; transition: 0.3s; }
        .btn-save:hover { background: #2ea043; }

        .btn-cancel { display:block; text-align:center; margin-top: 10px; color: #8b949e; text-decoration:none; font-size:0.9rem; transition: 0.3s; }
        .btn-cancel:hover { color: #ff3b30; }
    </style>
</head>
<body>
    <div class="edit-box">
        <h2>Update Operator Records</h2>
        <form action="{{ url_for('edit_profile') }}" method="POST">
            <div class="form-grid">
                <div><label>Full Name</label><input type="text" name="name" value="{{ user_info.name }}" required></div>
                <div><label>Email</label><input type="email" name="email" value="{{ user_info.email }}" required></div>
                <div><label>Phone</label><input type="tel" name="phoneNumber" value="{{ user_info.contact_number }}" required></div>
                <div><label>Address</label><input type="text" name="address" value="{{ user_info.address }}" required></div>
                <div><label>Vehicle ID</label><input type="text" name="vehicleId" value="{{ user_info.vehicle_id }}" required></div>

                <div>
                    <label>Car Brand</label>
                    <select id="carBrand" name="carBrand" required onchange="updateModels()">
                        <option value="" disabled>-- Select Brand --</option>
                        <option value="MARUTI SUZUKI">MARUTI SUZUKI</option>
                        <option value="HYUNDAI">HYUNDAI</option>
                        <option value="TATA MOTORS">TATA MOTORS</option>
                        <option value="MAHINDRA">MAHINDRA</option>
                        <option value="TOYOTA">TOYOTA</option>
                        <option value="KIA">KIA</option>
                        <option value="HONDA">HONDA</option>
                        <option value="VOLKSWAGEN">VOLKSWAGEN</option>
                        <option value="SKODA">SKODA</option>
                        <option value="RENAULT">RENAULT</option>
                        <option value="NISSAN">NISSAN</option>
                        <option value="MG">MG</option>
                        <option value="JEEP">JEEP</option>
                        <option value="FORD">FORD</option>
                        <option value="CITROEN">CITROEN</option>
                        <option value="AUDI">AUDI</option>
                        <option value="BMW">BMW</option>
                        <option value="MERCEDES-BENZ">MERCEDES-BENZ</option>
                        <option value="VOLVO">VOLVO</option>
                        <option value="LAND ROVER">LAND ROVER</option>
                        <option value="JAGUAR">JAGUAR</option>
                        <option value="BYD">BYD</option>
                        <option value="FORCE">FORCE</option>
                        <option value="ISUZU">ISUZU</option>
                    </select>
                </div>
                <div>
                    <label>Car Model</label>
                    <select id="carModel" name="carModel" required>
                        <option value="" disabled>-- Select Model --</option>
                    </select>
                </div>
            </div>

            <input type="hidden" id="initialBrand" value="{{ user_info.car_brand }}">
            <input type="hidden" id="initialModel" value="{{ user_info.model }}">

            <button type="submit" class="btn-save">SAVE RECORDS</button>
            <a href="/view_profile" class="btn-cancel">CANCEL UPDATE</a>
        </form>
    </div>

    <script>
        // Full Dataset
        const carData = {
            "MARUTI SUZUKI": ["Alto K10", "S-Presso", "Celerio", "Wagon R", "Ignis", "Swift", "Baleno", "Dzire", "Ciaz", "Brezza", "Fronx", "Grand Vitara", "Ertiga", "XL6", "Jimny", "Invicto"],
            "HYUNDAI": ["Santro", "Grand i10 Nios", "i20", "Aura", "Verna", "Venue", "Exter", "Creta", "Alcazar", "Tucson", "Kona", "Ioniq 5"],
            "TATA MOTORS": ["Tiago", "Tigor", "Altroz", "Punch", "Nexon", "Harrier", "Safari", "Curvv", "Tiago EV", "Nexon EV"],
            "MAHINDRA": ["Bolero", "Bolero Neo", "Scorpio Classic", "Scorpio N", "Thar", "XUV 3XO", "XUV400", "XUV700", "Marazzo"],
            "TOYOTA": ["Glanza", "Rumion", "Hyryder", "Innova Crysta", "Innova Hycross", "Fortuner", "Camry", "Vellfire", "Hilux"],
            "KIA": ["Sonet", "Seltos", "Carens", "Carnival", "EV6"],
            "HONDA": ["Amaze", "City", "Elevate", "Jazz", "WR-V"],
            "VOLKSWAGEN": ["Polo", "Vento", "Virtus", "Taigun", "Tiguan"],
            "SKODA": ["Slavia", "Kushaq", "Kodiaq", "Superb"],
            "RENAULT": ["Kwid", "Triber", "Kiger", "Duster"],
            "NISSAN": ["Magnite", "X-Trail"],
            "MG": ["Hector", "Hector Plus", "Astor", "Gloster", "Comet EV", "ZS EV"],
            "JEEP": ["Compass", "Meridian", "Wrangler"],
            "FORD": ["EcoSport", "Figo", "Aspire", "Endeavour"],
            "CITROEN": ["C3", "eC3", "C3 Aircross", "Basalt"],
            "AUDI": ["A4", "A6", "Q3", "Q5", "Q7"],
            "BMW": ["3 Series", "5 Series", "X1", "X3", "X5"],
            "MERCEDES-BENZ": ["C-Class", "E-Class", "GLA", "GLC", "GLE"],
            "VOLVO": ["XC40", "XC60"],
            "LAND ROVER": ["Discovery Sport", "Range Rover Evoque"],
            "JAGUAR": ["F-Pace", "XF"],
            "BYD": ["Atto 3", "Seal"],
            "FORCE": ["Gurkha"],
            "ISUZU": ["V-Cross"]
        };

        function updateModels(preSelectedModel = null) {
            const brandSelect = document.getElementById("carBrand");
            const modelSelect = document.getElementById("carModel");
            const selectedBrand = brandSelect.value;

            // Clear existing models
            modelSelect.innerHTML = '<option value="" disabled selected>-- Select Model --</option>';

            if (selectedBrand && carData[selectedBrand]) {
                modelSelect.disabled = false;
                carData[selectedBrand].forEach(function(model) {
                    const option = document.createElement("option");
                    option.value = model;
                    option.text = model;
                    if (model === preSelectedModel) {
                        option.selected = true;
                    }
                    modelSelect.appendChild(option);
                });
            } else {
                modelSelect.disabled = true;
            }
        }

        // Initialize functionality on page load
        window.onload = function() {
            const initialBrand = document.getElementById('initialBrand').value;
            const initialModel = document.getElementById('initialModel').value;
            const brandSelect = document.getElementById('carBrand');

            // Set the brand logic
            if (initialBrand) {
                for(let i=0; i < brandSelect.options.length; i++) {
                    if(brandSelect.options[i].value === initialBrand) {
                        brandSelect.selectedIndex = i;
                        break;
                    }
                }
                updateModels(initialModel);
            }
        };
    </script>
</body>
</html>
